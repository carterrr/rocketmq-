<project version="4">
  <component name="BookmarksManager">
    <option name="groups">
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1005" />
            </attributes>
            <option name="description" value="// 1. 开启异步刷盘时 如果TransientStorePoolEnable为true 则通过堆外内存池中申请一个和commitlog同样大小的堆外内存并锁定，确保不会swap出内存，然后再写入文件/  为false时直接追加到映射的内存并写入文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="default" value="true" />
        <option name="name" value="消息存储流程之异步刷盘" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1505" />
            </attributes>
            <option name="description" value="// 8. 更新存盘点  但是没有刷盘  实际刷存盘点的服务是 FlushConsumeQueueService 刷到 /rocketmq/dataDir/config  下面" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="982" />
            </attributes>
            <option name="description" value="// 3. 请求对象提交到刷盘服务service中  其中直接唤醒刷盘服务" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1499" />
            </attributes>
            <option name="description" value="//  7. 唤醒请求线程 并告知刷盘结果" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1490" />
            </attributes>
            <option name="description" value="// 6. 刷盘指针  小于 请求刷盘的offset  时可以刷盘  此时flushOK为false" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1483" />
            </attributes>
            <option name="description" value="// 5. 遍历集合中所有请求" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1528" />
            </attributes>
            <option name="description" value="// 4. 同步刷盘唤醒后执行的方法" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="975" />
            </attributes>
            <option name="description" value="// 1. 判断是否同步刷盘" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="980" />
            </attributes>
            <option name="description" value="// 2. 创建刷盘请求对象" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="消息存储流程之同步刷盘" />
      </GroupState>
      <GroupState>
        <option name="name" value="消息存储流程之过期删除" />
      </GroupState>
      <GroupState>
        <option name="name" value="消息存储流程之同步双写" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1437" />
            </attributes>
            <option name="description" value="// 14. 异常退出恢复  与正常恢复流程基本相同 差异 ： 1. 从最后一个commitlog文件倒推找到一个正常的文件而不是从倒数第三个开始 2. 需要转发到consume queue 和 indexfile" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="475" />
            </attributes>
            <option name="description" value="// 16.  需要额外做消息转发 转发到 consumequeue 和 indexfile" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="451" />
            </attributes>
            <option name="description" value="// 15. 判断该commitlog 文件是否正确 找到第一个消息存储正常的文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="236" />
            </attributes>
            <option name="description" value="// 13. 如果commitlog文件夹下没有文件则销毁consumequeue 下 的文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="230" />
            </attributes>
            <option name="description" value="// 12. 删除 processOffset 后无效的consumequeue中的脏数据  保证consumequeue 的最大offset  和 commitlog的最大offset 一致" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="223" />
            </attributes>
            <option name="description" value="// 11. 更新 MappedFileQueue的 flushedWhere 和 committedWhere指针" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="217" />
            </attributes>
            <option name="description" value="// 10.3 查找结果为false  表明该文件的1G并未填满消息 还有空余  已经查找到了commitlog的末尾 跳出循环" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="197" />
            </attributes>
            <option name="description" value="// 10.2 如果查找结果为true 且长度为0  表示消息正确 但是这个mappedFile已经处理完了" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="193" />
            </attributes>
            <option name="description" value="// 10.1 查找结果为true  且 消息长度&gt; 0 表示消息正确   继续下一轮迭代" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="183" />
            </attributes>
            <option name="description" value="// 10. 拿到commitlog已确认的物理偏移量  注意 这里是倒数第三个mappedfile的**起始偏移量**  加上后边每个文件总长度" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="175" />
            </attributes>
            <option name="description" value="// 9. broker正常停止再重启时  从倒数第三个commitlog文件开始恢复  若不足3个文件 从第一个开始恢复" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1434" />
            </attributes>
            <option name="description" value="// 8. 正常退出恢复" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="213" />
            </attributes>
            <option name="description" value="// 7. 重点 ：恢复文件过程" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
              <entry key="line" value="64" />
            </attributes>
            <option name="description" value="// 6. 恢复内存中的IndexFile对象  如果上次是异常退出的 且最后保存的index时间戳大于刷盘点   就把对应的indexFile文件删除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="208" />
            </attributes>
            <option name="description" value="// 5. 将checkpoint文件 转为内存中的checkpoint对象 用于后续记录刷盘点   文件检查点在config文件（与commitlog文件夹平级）中  存放上一次转发的位置" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="204" />
            </attributes>
            <option name="description" value="// 4. 加载消息消费队列store/consumequeue文件夹下的文件  转换为ConsumeQueue对象 到内存中的consumeQueueTable中" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="201" />
            </attributes>
            <option name="description" value="//  3. 加载store/commitlog 文件夹下的文件并按文件名排序 加载为jvm内存中的mappedfile对象" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="197" />
            </attributes>
            <option name="description" value="// 2. 加载磁盘上的延迟队列到本地   延迟消息消费进度存储路径为 /store/config/delayOffset.json" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="191" />
            </attributes>
            <option name="description" value="// 1. 判断是否异常关闭  如果存在abort文件  则异常关闭  ps ： abort文件当rocketmq启动时创建  创建后正常关闭时删除  异常则不会删除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="183" />
            </attributes>
            <option name="description" value="* 0. 消息存储到commitlog后宕机 并未异步转发到consumeQueue &amp; index文件时的异常恢复入口  这里保证最终一致性" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="消息存储流程之ConsumeQueue和Index恢复流程" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
              <entry key="line" value="234" />
            </attributes>
            <option name="description" value="// 14. 根据自定义业务id构建索引" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
              <entry key="line" value="225" />
            </attributes>
            <option name="description" value="// 13. 根据消息id构建索引index  req.getUniqKey()  再将index放到索引文件中（putKey方法完成）" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
              <entry key="line" value="206" />
            </attributes>
            <option name="description" value="// 12. 获得索引文件最大偏移量 endPhyOffset  排除重复转发的情况" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
              <entry key="line" value="203" />
            </attributes>
            <option name="description" value="// 11. 获取或者创建索引文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1611" />
            </attributes>
            <option name="description" value="// 10. 转发到index文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/ConsumeQueue.java" />
              <entry key="line" value="475" />
            </attributes>
            <option name="description" value="// 9. 通过mappedFile追加数据 注意 只追加到内存 并不刷盘" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/ConsumeQueue.java" />
              <entry key="line" value="433" />
            </attributes>
            <option name="description" value="// 8. 向byteBUffer  追加偏移量 消息长度 tag  组装要追加到consumeQueue文件中的数据" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1533" />
            </attributes>
            <option name="description" value="// 7. 通过主题和队列id拿到队列" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1596" />
            </attributes>
            <option name="description" value="// 6. 转发到consumequeue" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1983" />
            </attributes>
            <option name="description" value="// 5. 转发每条消息 组合模式通过两个dispatcher来转发dispatchRequest" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="1969" />
            </attributes>
            <option name="description" value="// 4. 拿到从reputFromOffset开始的全部有效数据  进行逐条遍历" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="2046" />
            </attributes>
            <option name="description" value="// 3. 每隔1毫秒 执行一次真正的转发方法" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="277" />
            </attributes>
            <option name="description" value="// 2. 启动分发任务处理  准实时转发commitLog文件更新事件触发 更新 consumerqueue indexFile 文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="249" />
            </attributes>
            <option name="description" value="// 1. 找到consumeQueue中的最大offset 设置为转发commitLog的起始offset" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="消息存储流程之ConsumeQueue和Index转发流程" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="919" />
            </attributes>
            <option name="description" value="// 18. 如果是master判断是否需要同步双写（需要等待主从同步完成）并进行同步双写" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="917" />
            </attributes>
            <option name="description" value="// 17. 依据刷盘模式进行同步刷盘 or 异步刷盘" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="900" />
            </attributes>
            <option name="description" value="// 16. 解锁" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1748" />
            </attributes>
            <option name="description" value="// 15. 写入完成 更新消息队列偏移量" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1735" />
            </attributes>
            <option name="description" value="// 14. 将消息追加到内存中  后续步骤依据同步刷盘还是异步刷盘模式写到磁盘中" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1673" />
            </attributes>
            <option name="description" value="// 13. 如果offset超过了文件1GB的限制 返回需要创建新commitLog文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1662" />
            </attributes>
            <option name="description" value="// 12. 计算消息的总长度  所有长度综合" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1623" />
            </attributes>
            <option name="description" value="// 11. 获得消息在队列中的偏移量  从队列中对应位置上开始写" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="1610" />
            </attributes>
            <option name="description" value="// 10. 设置全局唯一消息id 4字节ip + 4字节端口号 + 8字节消息偏移量  UtilAll.string2bytes方法能将msgId字符串还原成16字节的数组  根据提取的消息物理偏移量" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFile.java" />
              <entry key="line" value="206" />
            </attributes>
            <option name="description" value="// 9. 拿到写指针  从写指针开始往后写 写指针比文件大小小 才可以写 否则就是已经写满了" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="868" />
            </attributes>
            <option name="description" value="// 8. 追加消息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="847" />
            </attributes>
            <option name="description" value="// 7. 拿到最后一个commitlog文件 并加锁  mappedFileQueue对应commitlog文件夹 MappedFile是commitlog文件夹下的单个文件" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
              <entry key="line" value="817" />
            </attributes>
            <option name="description" value="// 6. 延迟级别大于0 说明是延时消息或消息重试 把消息的真实主题和queueid存储到消息属性中 并修改为延时topic 和延时 queueid" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
              <entry key="line" value="495" />
            </attributes>
            <option name="description" value="// 5. 检查各种状态 broker是否启动、支持写入 topic是否过长 消息属性是否过长 磁盘空间是否足够" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java" />
              <entry key="line" value="552" />
            </attributes>
            <option name="description" value="// 1. 注册发送到broker的消息处理器   netty客户端根据命令码取出processor来处理" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/processor/SendMessageProcessor.java" />
              <entry key="line" value="302" />
            </attributes>
            <option name="description" value="// 4. 非事务消息异步" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/processor/SendMessageProcessor.java" />
              <entry key="line" value="101" />
            </attributes>
            <option name="description" value="// 3. 非批量消息异步" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/processor/SendMessageProcessor.java" />
              <entry key="line" value="72" />
            </attributes>
            <option name="description" value="// 2. 异步处理请求" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="消息存储流程" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="832" />
            </attributes>
            <option name="description" value="// 6.8 根据同异步单项的模式进行发送" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="805" />
            </attributes>
            <option name="description" value="// 6.7 构造请求包" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="784" />
            </attributes>
            <option name="description" value="// 6.6 如果通过defaultMQProducer.registerHook注册了钩子方法 发送前调用所有的钩子类的executeSendMessageHookBefore方法  发送后调用executeSendMessageHookAfter方法" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="767" />
            </attributes>
            <option name="description" value="// 6.5 如果是事务消息 添加事务消息标志" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="761" />
            </attributes>
            <option name="description" value="// 6.4 尝试压缩 超过 4kb 的消息体" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="749" />
            </attributes>
            <option name="description" value="// 6.3 分配消息的全局唯一ID" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="742" />
            </attributes>
            <option name="description" value="// 6.2 获得broker网络地址" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="732" />
            </attributes>
            <option name="description" value="// 6.1 在brokerAddrTable中查找masterbroker的地址  如果没找到就到远程查询" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="618" />
            </attributes>
            <option name="description" value="// 8. 注意此处及后面的异常中的故障列表更新   isolation传的是true 最终结果是该broker 10分钟之内在开启故障延迟情况下不会选择到" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="597" />
            </attributes>
            <option name="description" value="// 7. 通过发送时间 预测不可用时间  注意更新不可用时间的逻辑  isolation为false的话依据实际时间来预测不可用时间" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="594" />
            </attributes>
            <option name="description" value="// 6. 真正的发送消息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/latency/MQFaultStrategy.java" />
              <entry key="line" value="102" />
            </attributes>
            <option name="description" value="// 5. 没有开启故障延迟的话  取上次没发送过的broker返回  ** 只避开上次发送失败的那个队列 ** （因为路由信息和nameserver是定时同步的 可能暂时没有同步完成）" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/latency/MQFaultStrategy.java" />
              <entry key="line" value="58" />
            </attributes>
            <option name="description" value="// 4. 如果开启了故障延迟的话  额外保存了处于故障期的broker列表 选择的时候不选择故障期的broker" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="578" />
            </attributes>
            <option name="description" value="// 3. 选择队列   上一次发送的broker   发过就不发了  负载均衡" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="564" />
            </attributes>
            <option name="description" value="// 2. 查询路由 查找主题对应的broker信息  先从缓存中找 没找到再去namesrv远程查询" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="558" />
            </attributes>
            <option name="description" value="// 1. 验证消息   验证消息对象的 主题非空  消息体（非空 null 或 &quot;&quot; / 超过4M）" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="1313" />
            </attributes>
            <option name="description" value="* 0. 发送消息入口" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/common/src/main/java/org/apache/rocketmq/common/message/Message.java" />
              <entry key="line" value="39" />
            </attributes>
            <option name="description" value="// 0. 消息topic 、用于过滤的消息tag  、消息索引键 用空格个隔开、消息发送时是否等待存储完成才返回" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="消息发送流程(DefaultMQProducer.send方法)" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/producer/DefaultMQProducer.java" />
              <entry key="line" value="901" />
            </attributes>
            <option name="description" value="// 1. 批量消息发送前打包成一条后复用原单条发送逻辑" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="批量消息发送流程" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="206" />
            </attributes>
            <option name="description" value="// 5. 启动客户端mqClientInstance实例" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="194" />
            </attributes>
            <option name="description" value="// 4.  注册自身到mqClientInstance的 producerTable 中  一个client有多个producer group 用来网络请求和心跳检测" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="191" />
            </attributes>
            <option name="description" value="// 3. 通过mqClientManager获得客户端MQClientInstance实例  后续使用该实例同broker通信  同时若首次获取创建到 mqClientManager 的 factoryTable 中" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/producer/DefaultMQProducerImpl.java" />
              <entry key="line" value="187" />
            </attributes>
            <option name="description" value="// 2. 提供一个单机多jvm实例 producer的 instancename修改机会" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/producer/DefaultMQProducer.java" />
              <entry key="line" value="272" />
            </attributes>
            <option name="description" value="// 1. 生产者启动方法 defaultProducer只是一个客户端 继承了MQAdmin 包含了一些topic  offset  message的操作，真正的客户端启动是下面的impl的启动" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="生产者启动流程" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/processor/DefaultRequestProcessor.java" />
              <entry key="line" value="105" />
            </attributes>
            <option name="description" value="// 3. 路由发现  生产者/消费者 主动来通过路由信息获取路由信息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/processor/DefaultRequestProcessor.java" />
              <entry key="line" value="358" />
            </attributes>
            <option name="description" value="// 5. 如果是顺序消息 填充顺序消息的conf到响应中" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/factory/MQClientInstance.java" />
              <entry key="line" value="270" />
            </attributes>
            <option name="description" value="// 1. 生产者消费者定时查询nameserver上的topic信息  注意这个类在生产者消费者中都会调用start方法" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/client/src/main/java/org/apache/rocketmq/client/impl/factory/MQClientInstance.java" />
              <entry key="line" value="357" />
            </attributes>
            <option name="description" value="// 2. 遍历所有producer关联的topic  更新topic的路由信息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="396" />
            </attributes>
            <option name="description" value="// 4. 分别从topicQueueTable，brokerAddrTable，filterServerTable取出queue信息 broker信息 消息过滤服务器信息返回" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="nameserver路由发现(生产者消费者主动查询路由信息)" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="544" />
            </attributes>
            <option name="description" value="// 5. 遍历所有的topic  若其对应的 queue是需要移除的broker上的 则移除 移除后无其他queue 则整个topic移除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="522" />
            </attributes>
            <option name="description" value="// 4. 如果将改broker移除  也需要从cluster中移除 若移除后cluster无其他broker  将cluster移除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="495" />
            </attributes>
            <option name="description" value="// 3. 从broker列表的主从列表种移除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="489" />
            </attributes>
            <option name="description" value="// 2. 如果找到broker需要删除 此时加写锁 从 brokerLiveTable  filterServerTable 直接移除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/NamesrvController.java" />
              <entry key="line" value="85" />
            </attributes>
            <option name="description" value="// 1.  启动5秒后每隔10秒 关闭120秒内未上送信息的不活跃broker链接" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="nameserver路由删除" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="164" />
            </attributes>
            <option name="description" value="// 11. 更新brokerLiveTable 保存存活broker方便路由删除" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="150" />
            </attributes>
            <option name="description" value="// 10. 主节点topic信息发生变化or第一次注册  更新topicQueueTable 源信息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/routeinfo/RouteInfoManager.java" />
              <entry key="line" value="51" />
            </attributes>
            <option name="description" value="// 0. 注意路由源信息结构" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/out/BrokerOuterAPI.java" />
              <entry key="line" value="128" />
            </attributes>
            <option name="description" value="// 3. 构造请求头" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/out/BrokerOuterAPI.java" />
              <entry key="line" value="136" />
            </attributes>
            <option name="description" value="// 4. 构造请求体" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/out/BrokerOuterAPI.java" />
              <entry key="line" value="144" />
            </attributes>
            <option name="description" value="// 5. 遍历namesrv地址  通过nettyclient分别注册broker自身的信息" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java" />
              <entry key="line" value="889" />
            </attributes>
            <option name="description" value="// 1. broker在 启动后10秒  每隔30秒向namesrv发送心跳包" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java" />
              <entry key="line" value="958" />
            </attributes>
            <option name="description" value="// 2.  broker真正发送心跳包的地方   调用brokerOuterAPI" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java" />
              <entry key="line" value="973" />
            </attributes>
            <option name="description" value="// 6. nameserver返回的主节点地址，拿来更新从节点自身的主节点地址" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="nameserver路由注册" />
      </GroupState>
      <GroupState>
        <option name="bookmarks">
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/NamesrvStartup.java" />
              <entry key="line" value="80" />
            </attributes>
            <option name="description" value="// step1 创建两个配置类  并用 -c 配置文件 和 -p 命令行配置 覆盖配置类的配置" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/NamesrvStartup.java" />
              <entry key="line" value="140" />
            </attributes>
            <option name="description" value="// step2 启动NameserverController  创建nettyserver 并 启动10s一次的broker扫描  10min一次的 kv配置打印" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
          <BookmarkState>
            <attributes>
              <entry key="url" value="file://$PROJECT_DIR$/namesrv/src/main/java/org/apache/rocketmq/namesrv/NamesrvStartup.java" />
              <entry key="line" value="146" />
            </attributes>
            <option name="description" value="// step3 注册钩子方法 在jvm关闭时关闭nameserver相关资源 如线程池" />
            <option name="provider" value="com.intellij.ide.bookmark.providers.LineBookmarkProvider" />
          </BookmarkState>
        </option>
        <option name="name" value="nameserver的启动流程" />
      </GroupState>
    </option>
  </component>
  <component name="FileEditorManager">
    <leaf SIDE_TABS_SIZE_LIMIT_KEY="-1">
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="211">
              <caret line="1508" column="24" selection-start-line="1508" selection-start-column="24" selection-end-line="1508" selection-end-column="24" />
              <folding>
                <element signature="e#60666#60667#0" expanded="true" />
                <element signature="e#60704#60705#0" expanded="true" />
              </folding>
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/StoreCheckpoint.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="193">
              <caret line="77" column="17" lean-forward="true" selection-start-line="77" selection-start-column="17" selection-end-line="77" selection-end-column="17" />
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/README.md">
          <provider selected="true" editor-type-id="split-provider[text-editor;markdown-preview-editor]" />
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/2FtqSyxLJD9ffqeErl6AixIjPJd.xml">
          <provider selected="true" editor-type-id="text-editor" />
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/ConsumeQueue.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="305">
              <caret line="550" column="16" selection-start-line="550" selection-start-column="16" selection-end-line="550" selection-end-column="16" />
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="true">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="299">
              <caret line="1008" lean-forward="true" selection-start-line="1008" selection-end-line="1008" />
              <folding>
                <element signature="e#8167#8232#1" />
                <element signature="e#45149#46697#1" />
                <element signature="e#66226#66246#0" expanded="true" />
                <element signature="e#69919#69920#0" expanded="true" />
                <element signature="e#69962#69963#0" expanded="true" />
              </folding>
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFileQueue.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="189">
              <caret line="431" column="19" selection-start-line="431" selection-start-column="19" selection-end-line="431" selection-end-column="19" />
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFile.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="22">
              <caret line="278" column="15" selection-start-line="278" selection-start-column="15" selection-end-line="278" selection-end-column="15" />
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="jar:///Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/src.zip!/java/util/concurrent/CompletableFuture.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="237">
              <caret line="1974" column="16" lean-forward="true" selection-start-line="1974" selection-start-column="16" selection-end-line="1974" selection-end-column="16" />
            </state>
          </provider>
        </entry>
      </file>
      <file pinned="false" current-in-tab="false">
        <entry file="file://$PROJECT_DIR$/common/src/main/java/org/apache/rocketmq/common/ServiceThread.java">
          <provider selected="true" editor-type-id="text-editor">
            <state relative-caret-position="193">
              <caret line="124" column="16" selection-start-line="124" selection-start-column="16" selection-end-line="124" selection-end-column="16" />
            </state>
          </provider>
        </entry>
      </file>
    </leaf>
  </component>
  <component name="FileTypeUsageLocalSummary">
    <fileType name="JAVA">
      <summary usageCount="22" lastUsed="1666782096851" />
    </fileType>
    <fileType name="Markdown">
      <summary usageCount="1" lastUsed="1666756993174" />
    </fileType>
    <fileType name="XML">
      <summary usageCount="3" lastUsed="1666757320164" />
    </fileType>
  </component>
  <component name="IdeDocumentHistory">
    <changedPaths>
      <option value="$PROJECT_DIR$/common/src/main/java/org/apache/rocketmq/common/ConfigManager.java" />
      <option value="$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java" />
      <option value="$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFile.java" />
      <option value="$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java" />
      <option value="$PROJECT_DIR$/README.md" />
      <option value="$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java" />
    </changedPaths>
  </component>
  <component name="IgnoredFileRootStore">
    <option name="generatedRoots">
      <set>
        <option value="$PROJECT_DIR$/.idea" />
      </set>
    </option>
  </component>
  <component name="ProjectView">
    <navigator currentView="ProjectPane" proportions="" version="1" />
    <panes>
      <pane id="PackagesPane" />
      <pane id="ProjectPane">
        <subPane>
          <expand>
            <path>
              <item name="rocketmq_annotation" type="b2602c69:ProjectViewProjectNode" />
              <item name="rocketmq_annotation" type="462c0819:PsiDirectoryNode" />
            </path>
            <path>
              <item name="rocketmq_annotation" type="b2602c69:ProjectViewProjectNode" />
              <item name="rocketmq_annotation" type="462c0819:PsiDirectoryNode" />
              <item name="distribution" type="462c0819:PsiDirectoryNode" />
            </path>
            <path>
              <item name="rocketmq_annotation" type="b2602c69:ProjectViewProjectNode" />
              <item name="rocketmq_annotation" type="462c0819:PsiDirectoryNode" />
              <item name="distribution" type="462c0819:PsiDirectoryNode" />
              <item name="conf" type="462c0819:PsiDirectoryNode" />
            </path>
          </expand>
          <select />
        </subPane>
      </pane>
      <pane id="Scope" />
    </panes>
  </component>
  <component name="TerminalArrangementManager">
    <option name="myTabStates">
      <TerminalTabState tabName="Local" currentWorkingDirectory="$PROJECT_DIR$" commandHistoryFileName="rocketmq_annotation-history1" />
    </option>
  </component>
  <component name="TimeTrackingManager">
    <option name="totallyTimeSpent" value="20104000" />
  </component>
  <component name="ToolWindowManager">
    <editor active="true" />
    <layout>
      <window_info content_ui="combo" id="Project" order="0" visible="true" weight="0.25" />
      <window_info id="Structure" order="1" side_tool="true" weight="0.25" />
      <window_info id="Bookmarks" order="2" side_tool="true" visible="true" weight="0.25" />
      <window_info id="Commit" order="3" />
      <window_info id="Learn" order="4" />
      <window_info id="Pull Requests" order="5" />
      <window_info id="Space Code Reviews" order="6" />
      <window_info anchor="bottom" id="Dependencies" order="0" />
      <window_info anchor="bottom" id="Version Control" order="1" />
      <window_info anchor="bottom" id="Event Log" order="2" side_tool="true" />
      <window_info anchor="bottom" id="Find" order="3" />
      <window_info anchor="bottom" id="Run" order="4" />
      <window_info anchor="bottom" id="Debug" order="5" weight="0.4" />
      <window_info anchor="bottom" id="TODO" order="6" />
      <window_info anchor="bottom" id="Problems View" order="7" />
      <window_info anchor="bottom" id="Inspection" order="8" weight="0.4" />
      <window_info anchor="bottom" id="Profiler" order="9" />
      <window_info anchor="bottom" id="Internal Method Tracing" order="10" />
      <window_info anchor="bottom" id="File Transfer" order="11" />
      <window_info anchor="bottom" id="Terminal" order="12" visible="true" weight="0.33033174" />
      <window_info anchor="bottom" id="Database Changes" order="13" show_stripe_button="false" />
      <window_info anchor="bottom" id="TypeScript" order="14" />
      <window_info anchor="bottom" id="Endpoints" order="15" show_stripe_button="false" />
      <window_info anchor="bottom" id="Flow" order="16" />
      <window_info anchor="bottom" id="Services" order="17" show_stripe_button="false" />
      <window_info anchor="right" id="Space Automation" order="0" />
      <window_info anchor="right" id="Maven" order="1" />
      <window_info anchor="right" id="Database" order="2" />
      <window_info anchor="right" id="Layout Validation" order="3" />
      <window_info anchor="right" id="documentation.v2" order="4" side_tool="true" />
    </layout>
    <recentWindows>
      <value>Terminal</value>
      <value>Bookmarks</value>
      <value>Project</value>
      <value>Structure</value>
    </recentWindows>
  </component>
  <component name="Trusted.Project.Settings" hasCheckedIfOldProject="true" />
  <component name="WindowStateProjectService">
    <state x="2131" y="259" width="670" height="683" key="search.everywhere.popup" timestamp="1666779796510">
      <screen x="63" y="25" width="3377" height="1415" />
    </state>
    <state x="2131" y="259" width="670" height="683" key="search.everywhere.popup/63.25.3377.1415@63.25.3377.1415" timestamp="1666779796510" />
  </component>
  <component name="editorHistoryManager">
    <entry file="file://$PROJECT_DIR$/distribution/conf/logback_broker.xml">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="550">
          <caret line="25" column="26" selection-start-line="25" selection-start-column="26" selection-end-line="25" selection-end-column="26" />
        </state>
      </provider>
    </entry>
    <entry file="jar:///Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/src.zip!/java/lang/Runtime.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="309">
          <caret line="206" column="16" selection-start-line="206" selection-start-column="16" selection-end-line="206" selection-end-column="16" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerStartup.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="110">
          <caret line="50" column="17" lean-forward="true" selection-start-line="50" selection-start-column="17" selection-end-line="50" selection-end-column="17" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/config/StorePathConfigHelper.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="511">
          <caret line="46" column="25" selection-start-line="46" selection-start-column="25" selection-end-line="46" selection-end-column="25" />
          <folding>
            <element signature="e#1506#1507#0" expanded="true" />
            <element signature="e#1563#1564#0" expanded="true" />
          </folding>
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/common/src/main/java/org/apache/rocketmq/common/ConfigManager.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="445">
          <caret line="67" column="25" selection-start-line="67" selection-start-column="25" selection-end-line="67" selection-end-column="25" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/schedule/ScheduleMessageService.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="349">
          <caret line="180" column="67" selection-start-line="180" selection-start-column="40" selection-end-line="180" selection-end-column="67" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="824">
          <caret line="260" column="45" selection-start-line="260" selection-start-column="45" selection-end-line="260" selection-end-column="45" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/index/IndexService.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="309">
          <caret line="64" selection-start-line="64" selection-end-line="64" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/config/MessageStoreConfig.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="331">
          <caret line="276" column="27" lean-forward="true" selection-start-line="276" selection-start-column="27" selection-end-line="276" selection-end-column="27" />
          <folding>
            <element signature="e#10335#10336#0" expanded="true" />
            <element signature="e#10375#10376#0" expanded="true" />
          </folding>
        </state>
      </provider>
    </entry>
    <entry file="jar:///Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/src.zip!/java/nio/ByteBuffer.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="143">
          <caret line="499" selection-start-line="499" selection-end-line="499" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DispatchRequest.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="331">
          <caret line="114" column="18" lean-forward="true" selection-start-line="114" selection-start-column="18" selection-end-line="114" selection-end-column="18" />
          <folding>
            <element signature="e#3603#3604#0" expanded="true" />
            <element signature="e#3633#3634#0" expanded="true" />
          </folding>
        </state>
      </provider>
    </entry>
    <entry file="jar:///Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/src.zip!/java/util/List.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="309">
          <caret line="543" column="6" selection-start-line="543" selection-start-column="6" selection-end-line="543" selection-end-column="6" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/dledger/DLedgerCommitLog.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="305">
          <caret line="271" column="14" selection-start-line="271" selection-start-column="14" selection-end-line="271" selection-end-column="14" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/ConsumeQueue.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="305">
          <caret line="550" column="16" selection-start-line="550" selection-start-column="16" selection-end-line="550" selection-end-column="16" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/2FtqSyxLJD9ffqeErl6AixIjPJd.xml">
      <provider selected="true" editor-type-id="text-editor" />
    </entry>
    <entry file="file://$PROJECT_DIR$/README.md">
      <provider selected="true" editor-type-id="split-provider[text-editor;markdown-preview-editor]" />
    </entry>
    <entry file="file://$PROJECT_DIR$/common/src/main/java/org/apache/rocketmq/common/ServiceThread.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="193">
          <caret line="124" column="16" selection-start-line="124" selection-start-column="16" selection-end-line="124" selection-end-column="16" />
        </state>
      </provider>
    </entry>
    <entry file="jar:///Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/src.zip!/java/util/concurrent/CompletableFuture.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="237">
          <caret line="1974" column="16" lean-forward="true" selection-start-line="1974" selection-start-column="16" selection-end-line="1974" selection-end-column="16" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFile.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="22">
          <caret line="278" column="15" selection-start-line="278" selection-start-column="15" selection-end-line="278" selection-end-column="15" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/MappedFileQueue.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="189">
          <caret line="431" column="19" selection-start-line="431" selection-start-column="19" selection-end-line="431" selection-end-column="19" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/StoreCheckpoint.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="193">
          <caret line="77" column="17" lean-forward="true" selection-start-line="77" selection-start-column="17" selection-end-line="77" selection-end-column="17" />
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/DefaultMessageStore.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="211">
          <caret line="1508" column="24" selection-start-line="1508" selection-start-column="24" selection-end-line="1508" selection-end-column="24" />
          <folding>
            <element signature="e#60666#60667#0" expanded="true" />
            <element signature="e#60704#60705#0" expanded="true" />
          </folding>
        </state>
      </provider>
    </entry>
    <entry file="file://$PROJECT_DIR$/store/src/main/java/org/apache/rocketmq/store/CommitLog.java">
      <provider selected="true" editor-type-id="text-editor">
        <state relative-caret-position="299">
          <caret line="1008" lean-forward="true" selection-start-line="1008" selection-end-line="1008" />
          <folding>
            <element signature="e#8167#8232#1" />
            <element signature="e#45149#46697#1" />
            <element signature="e#66226#66246#0" expanded="true" />
            <element signature="e#69919#69920#0" expanded="true" />
            <element signature="e#69962#69963#0" expanded="true" />
          </folding>
        </state>
      </provider>
    </entry>
  </component>
</project>